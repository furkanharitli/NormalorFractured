

<style>
:root{--bg:#0f1724;--card:#0b1220;--muted:#94a3b8;--accent:#06b6d4}

.xr-container{max-width:820px;margin:40px auto;padding:24px}
.card{background:rgba(255,255,255,0.03);border-radius:12px;padding:20px;box-shadow:0 6px 18px rgba(2,6,23,0.6)}
h1{margin:0 0 8px;font-size:20px}
p.lead{margin:0 0 18px;color:var(--muted)}

.uploader{border:2px dashed rgba(255,255,255,0.07);padding:28px;border-radius:10px;display:flex;gap:18px;align-items:center}
.preview{width:220px;height:220px;background:#061223;border-radius:8px;display:flex;align-items:center;justify-content:center;overflow:hidden}
.preview img{max-width:100%;max-height:100%;object-fit:contain}

.controls{flex:1}
.btn{padding:10px 14px;border-radius:8px;border:0;background:var(--accent);color:#052025;font-weight:600;cursor:pointer}
.btn.secondary{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.04)}

.meta{margin-top:12px;color:var(--muted);font-size:14px}
.result{margin-top:16px;padding:12px;background:rgba(255,255,255,0.02);border-radius:8px;font-family:monospace}
input[type=file]{display:none}

.plots{margin-top:24px;display:none}
.plots img{max-width:100%;margin-bottom:12px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.4)}

@media (max-width:700px){
  .uploader{flex-direction:column}
  .preview{width:180px;height:180px}
}
</style>

<div class="xr-container">
  <div class="card">
    <h1>G√∂rsel Tanƒ±ma</h1>
    <p class="lead">Model i√ßin resim se√ß veya s√ºr√ºkle</p>

    <div class="uploader">
      <div class="preview" id="preview">√ñnizleme yok</div>

      <div class="controls">
        <label class="btn" for="fileInput">Resim Se√ß</label>
        <button class="btn secondary" id="sendBtn">Modeli √áaƒüƒ±r</button>
        <div class="meta">JPG / PNG ‚Ä¢ Max 10MB ‚Ä¢ <code>/predict</code></div>
      </div>
    </div>

    <input id="fileInput" type="file" accept="image/*">
    <div id="result" class="result" style="display:none"></div>

    <!-- üîΩ GRAFƒ∞KLER -->
    <div id="plots" class="plots">
      <h3>Model Performansƒ±</h3>
      <img id="conImg">
      <img id="rocImg">
      <img id="prImg">
    </div>
  </div>
</div>

<script>
const fileInput = document.getElementById("fileInput");
const preview = document.getElementById("preview");
const sendBtn = document.getElementById("sendBtn");
const resultBox = document.getElementById("result");

const plots = document.getElementById("plots");
const conImg = document.getElementById("conImg");
const rocImg = document.getElementById("rocImg");
const prImg  = document.getElementById("prImg");

// √ñnizleme
fileInput.addEventListener("change", () => {
  const file = fileInput.files[0];
  if (!file) return;
  preview.innerHTML = "";
  const img = document.createElement("img");
  img.src = URL.createObjectURL(file);
  preview.appendChild(img);
});

// Predict
sendBtn.addEventListener("click", async () => {
  if (!fileInput.files.length) {
    alert("Resim se√ß");
    return;
  }

  resultBox.style.display = "block";
  resultBox.innerText = "üîç Tahmin yapƒ±lƒ±yor...";

  const fd = new FormData();
  fd.append("image", fileInput.files[0]);

  try {
    const res = await fetch("/predict", { method:"POST", body: fd });
    const data = await res.json();

    resultBox.innerHTML = `
      <b>Sonu√ß:</b> ${data.prediction}<br>
      <b>G√ºven:</b> %${(data.confidence*100).toFixed(1)}
    `;

    // üî• GRAFƒ∞KLERƒ∞ Y√úKLE
    const t = Date.now();
    conImg.src = "/static/con.png?t=" + t;
    rocImg.src = "/static/roc.png?t=" + t;
    prImg.src  = "/static/pr.png?t=" + t;
    plots.style.display = "block";

  } catch (e) {
    resultBox.innerText = "‚ùå Hata olu≈ütu";
    console.error(e);
  }
});
</script>
