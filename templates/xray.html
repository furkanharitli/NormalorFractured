

<style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#94a3b8;--accent:#06b6d4}

    /* SORUN Ã‡IKARAN KISIM DÃœZELTÄ°LDÄ° */
    /* ARTIK .container DEÄÄ°L, SADECE BU SAYFAYA Ã–ZEL */
    .xr-container{max-width:820px;margin:40px auto;padding:24px}

    .card{background:rgba(255,255,255,0.03);border-radius:12px;padding:20px;box-shadow:0 6px 18px rgba(2,6,23,0.6)}
    h1{margin:0 0 8px;font-size:20px}
    p.lead{margin:0 0 18px;color:var(--muted)}
    .uploader{border:2px dashed rgba(255,255,255,0.07);padding:28px;border-radius:10px;display:flex;gap:18px;align-items:center}
    .uploader.dragover{background:linear-gradient(90deg, rgba(6,182,212,0.04), rgba(96,165,250,0.02));border-color:rgba(6,182,212,0.35)}
    .preview{width:220px;height:220px;background:#061223;border-radius:8px;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .preview img{max-width:100%;max-height:100%;object-fit:contain}
    .controls{flex:1}
    .btn{display:inline-block;padding:10px 14px;border-radius:8px;border:0;background:var(--accent);color:#052025;font-weight:600;cursor:pointer}
    .btn.secondary{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.04)}
    .meta{margin-top:12px;color:var(--muted);font-size:14px}
    .result{margin-top:16px;padding:12px;background:rgba(255,255,255,0.02);border-radius:8px;font-family:monospace;white-space:pre-wrap}
    input[type=file]{display:none}
    @media (max-width:700px){.uploader{flex-direction:column}.preview{width:180px;height:180px}}
</style>

<div class="xr-container">  <!-- ARTIK BUNU KULLANIYORUZ -->
    <div class="card">
        <h1>GÃ¶rsel TanÄ±ma - Resim YÃ¼kle</h1>
        <p class="lead">Modelinizin tanÄ±masÄ± iÃ§in resim seÃ§in veya buraya sÃ¼rÃ¼kleyin.</p>

        <div id="uploader" class="uploader">
            <div class="preview" id="preview">
                <span id="previewText">Ã–nizleme yok</span>
            </div>

            <div class="controls">
                <div style="display:flex;gap:8px;align-items:center">
                    <label class="btn" for="fileInput">Resim seÃ§</label>
                    <button type="button" class="btn secondary" id="sendBtn">Modeli Ã§aÄŸÄ±r</button>
                    <button type="button" class="btn secondary" id="clearBtn">Temizle</button>
                </div>

                <div class="meta">
                    Desteklenen: JPG, PNG. Maksimum: 10 MB.<br>
                    Endpoint: <code>/predict</code>
                </div>

                
            </div>
        </div>

        <input id="fileInput" type="file" accept="image/*" />
    </div>
    <div style="height: 200px;"></div
        >
        <div class="result" id="result" style="display:none"></div>

<!-- ğŸ”½ BURAYI EKLE -->
<div id="plotBox" style="margin-top:16px; display:none">
    <img id="plotImg" src="" style="max-width:100%; border-radius:8px;">
</div>
</div>
<script>
const fileInput = document.getElementById("fileInput");
const sendBtn = document.getElementById("sendBtn");
const resultBox = document.getElementById("result");
const preview = document.getElementById("preview");
const plotBox = document.getElementById("plotBox");
const plotImg = document.getElementById("plotImg");
plotImg.src = "/static/plotted.png?t=" + Date.now();
plotBox.style.display = "block";
// Ã–nizleme
fileInput.addEventListener("change", () => {
    const file = fileInput.files[0];
    if (!file) return;

    preview.innerHTML = "";
    const img = document.createElement("img");
    img.src = URL.createObjectURL(file);
    preview.appendChild(img);
});

// Predict
sendBtn.addEventListener("click", async (e) => {
    e.preventDefault();

    if (!fileInput.files.length) {
        alert("Resim seÃ§");
        return;
    }

    resultBox.style.display = "block";
    resultBox.innerHTML = "ğŸ” Tahmin yapÄ±lÄ±yor...";

    const formData = new FormData();
    formData.append("image", fileInput.files[0]);

    try {
        const res = await fetch("/predict", {
            method: "POST",
            body: formData
        });

        const data = await res.json();

        // ğŸ”¥ MODEL SONUCUNU OKU
        const tahmin = data.prediction;
        const conf = (data.confidence * 100).toFixed(1);

        resultBox.innerHTML = `
            <b>SonuÃ§:</b> ${tahmin}<br>
            <b>GÃ¼ven:</b> %${conf}
        `;

    } catch (err) {
        resultBox.innerHTML = "âŒ Tahmin sÄ±rasÄ±nda hata oluÅŸtu";
        console.error(err);
    }
});
</script>
